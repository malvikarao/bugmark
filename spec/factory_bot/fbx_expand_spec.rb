require 'rails_helper'

RSpec.describe 'FbxExpand', USE_VCR do
  describe "expand_obf" do
    it "runs without params", :focus do
      expect(Offer.count).to    eq(0)
      expect(Contract.count).to eq(0)
      expect(Escrow.count).to   eq(0)
      expect(Position.count).to eq(0)
      result = FBX.expand_obf
      expect(Offer.count).to    eq(2)
      expect(Contract.count).to eq(1)
      expect(Escrow.count).to   eq(1)
      expect(Position.count).to eq(2)
    end
  end

  describe "expand_obu" do
    it "runs without params" do
      expect(Offer.count).to    eq(0)
      expect(Contract.count).to eq(0)
      expect(Escrow.count).to   eq(0)
      expect(Position.count).to eq(0)
      FBX.expand_obu
      expect(Offer.count).to    eq(2)
      expect(Contract.count).to eq(1)
      expect(Escrow.count).to   eq(1)
      expect(Position.count).to eq(2)
    end
  end
end
